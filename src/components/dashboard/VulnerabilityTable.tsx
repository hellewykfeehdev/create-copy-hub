import { SeverityBadge } from "./SeverityBadge";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
import { ExternalLink, Clock } from "lucide-react";

interface Vulnerability {
  id: string;
  title: string;
  severity: "critical" | "high" | "medium" | "low" | "info";
  source: string;
  discovered: string;
  status: "open" | "in_progress" | "resolved";
}

const mockVulnerabilities: Vulnerability[] = [
  {
    id: "CVE-2024-1234",
    title: "SQL Injection in Authentication Module",
    severity: "critical",
    source: "auth-service",
    discovered: "2 hours ago",
    status: "open",
  },
  {
    id: "CVE-2024-5678",
    title: "Cross-Site Scripting (XSS) in User Input",
    severity: "high",
    source: "web-frontend",
    discovered: "5 hours ago",
    status: "in_progress",
  },
  {
    id: "CVE-2024-9012",
    title: "Insecure Direct Object Reference",
    severity: "medium",
    source: "api-gateway",
    discovered: "1 day ago",
    status: "open",
  },
  {
    id: "CVE-2024-3456",
    title: "Missing Rate Limiting on API Endpoints",
    severity: "medium",
    source: "api-gateway",
    discovered: "2 days ago",
    status: "resolved",
  },
  {
    id: "CVE-2024-7890",
    title: "Outdated Dependency with Known Vulnerability",
    severity: "low",
    source: "package.json",
    discovered: "3 days ago",
    status: "open",
  },
];

const statusStyles = {
  open: "text-destructive",
  in_progress: "text-warning",
  resolved: "text-success",
};

const statusLabels = {
  open: "Open",
  in_progress: "In Progress",
  resolved: "Resolved",
};

export function VulnerabilityTable() {
  return (
    <div className="glass-card rounded-lg overflow-hidden animate-fade-in-up">
      <div className="p-5 border-b border-border/50">
        <h3 className="text-lg font-semibold">Recent Vulnerabilities</h3>
        <p className="text-sm text-muted-foreground mt-1">Latest security findings from scans</p>
      </div>
      <Table>
        <TableHeader>
          <TableRow className="border-border/50 hover:bg-transparent">
            <TableHead className="text-muted-foreground">ID</TableHead>
            <TableHead className="text-muted-foreground">Title</TableHead>
            <TableHead className="text-muted-foreground">Severity</TableHead>
            <TableHead className="text-muted-foreground">Source</TableHead>
            <TableHead className="text-muted-foreground">Discovered</TableHead>
            <TableHead className="text-muted-foreground">Status</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {mockVulnerabilities.map((vuln) => (
            <TableRow key={vuln.id} className="border-border/50 hover:bg-muted/30 transition-colors">
              <TableCell className="font-mono text-sm text-primary">
                <span className="flex items-center gap-1.5">
                  {vuln.id}
                  <ExternalLink className="w-3 h-3 opacity-50" />
                </span>
              </TableCell>
              <TableCell className="font-medium max-w-[300px] truncate">{vuln.title}</TableCell>
              <TableCell>
                <SeverityBadge severity={vuln.severity} />
              </TableCell>
              <TableCell className="font-mono text-sm text-muted-foreground">{vuln.source}</TableCell>
              <TableCell>
                <span className="flex items-center gap-1.5 text-muted-foreground text-sm">
                  <Clock className="w-3 h-3" />
                  {vuln.discovered}
                </span>
              </TableCell>
              <TableCell>
                <span className={`text-sm font-medium ${statusStyles[vuln.status]}`}>
                  {statusLabels[vuln.status]}
                </span>
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </div>
  );
}
